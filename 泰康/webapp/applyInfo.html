<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>申请信息</title>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <script src="js/rem.js"></script>
    <link rel="stylesheet" href="style/layout.css">
    <link rel="stylesheet" href="style/mobiscroll.css">
</head>
<body>
<div class="tk_vM">

    <ul class="tk_pMLMenu">
        <li class="tk_pMLItem clear">
            <span class="tk_compItemN">申请人姓名</span>
            <input class="tk_pMDItemDIpt" type="text" placeholder="请输入">
        </li>
        <li class="tk_pMLItem clear">
            <span class="tk_compItemN">手机号码</span>
            <input class="tk_pMDItemDIpt" type="text" placeholder="请输入">
        </li>
        <li class="tk_pMLItem clear">
            <span class="tk_compItemN"><span class="tk_compItNStar">*</span>所在部门</span>
            <div class="tk_compItemC">
                <span class="tk_compItemCTxt">请选择</span>
                <div class="tk_compItCIcon"></div>
            </div>
            <div class="tk_compPopUp2Wrapper none">
                <div class="tk_compPopUp2">
                    <div class="tk_compPopUp2Title">部门选择</div>
                    <ul class="tk_compPopUp2Menu">
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">部门一</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="department" value="部门一">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">部门二</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="department" value="部门二">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">部门三</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="department" value="部门三">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">部门四</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="department" value="部门四">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">部门五</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="department" value="部门五">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">部门六</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="department" value="部门六">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">状态七</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="department" value="类型七">
                        </li>
                    </ul>
                    <div class="tk_compPopUp2BtnWrapper">
                        <div class="tk_compPopUp2Btn fl">确定</div>
                        <div class="tk_compPopUp2Btn fr">关闭</div>
                    </div>
                </div>
            </div>
        </li>
        <li class="tk_pMLItem clear">
            <span class="tk_compItemN">所在楼栋</span>
            <div class="tk_compItemC">
                <span class="tk_compItemCTxt">请选择</span>
                <div class="tk_compItCIcon"></div>
            </div>
            <div class="tk_compPopUp2Wrapper none">
                <div class="tk_compPopUp2">
                    <div class="tk_compPopUp2Title">楼栋选择</div>
                    <ul class="tk_compPopUp2Menu">
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼栋一</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="building" value="楼栋一">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼栋二</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="building" value="楼栋二">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼栋三</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="building" value="楼栋三">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼栋四</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="building" value="楼栋四">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼栋五</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="building" value="楼栋五">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼栋六</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="building" value="楼栋六">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">状态七</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="building" value="类型七">
                        </li>
                    </ul>
                    <div class="tk_compPopUp2BtnWrapper">
                        <div class="tk_compPopUp2Btn fl">确定</div>
                        <div class="tk_compPopUp2Btn fr">关闭</div>
                    </div>
                </div>
            </div>
        </li>
        <li class="tk_pMLItem clear">
            <span class="tk_compItemN">所在楼层</span>
            <div class="tk_compItemC">
                <span class="tk_compItemCTxt">请选择</span>
                <div class="tk_compItCIcon"></div>
            </div>
            <div class="tk_compPopUp2Wrapper none">
                <div class="tk_compPopUp2">
                    <div class="tk_compPopUp2Title">楼层选择</div>
                    <ul class="tk_compPopUp2Menu">
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼层一</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="floor" value="楼层一">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼层二</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="floor" value="楼层二">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼层三</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="floor" value="楼层三">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼层四</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="floor" value="楼层四">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼层五</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="floor" value="楼层五">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">楼层六</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="floor" value="楼层六">
                        </li>
                        <li class="tk_compPopUp2Item">
                            <label class="tk_compPopUp2ItName">状态七</label>
                            <input class="tk_compPopUp2ItIpt" type="radio" name="building" value="类型七">
                        </li>
                    </ul>
                    <div class="tk_compPopUp2BtnWrapper">
                        <div class="tk_compPopUp2Btn fl">确定</div>
                        <div class="tk_compPopUp2Btn fr">关闭</div>
                    </div>
                </div>
            </div>
        </li>
        <li class="tk_pMLItem clear">
            <span class="tk_compItemN">具体位置</span>
            <input class="tk_pMDItemDIpt" type="text" placeholder="请输入">
        </li>
    </ul>
    <ul class="tk_topTContent">
        <li class="tk_MCConItem2">
            <a class="tk_MCConItHref2" href="javascript:;">
                <div class="tk_MCConItTop clear">
                    <div class="tk_MCConItTitle">故障描述</div>
                </div>
                <ul class="tk_MCConItMenu">
                    <li class="tk_MCConItItem">
                        <p class="tk_MCConItPara">主机风扇照常转，键盘灯一起亮了一下然后再也没反 应，显示屏显没信号后、下面的灯变成红的，也没有 反应了，怎么办</p>
                    </li>
                </ul>
            </a>
        </li>

        <li class="tk_MCConItem2">
            <a class="tk_MCConItHref2" href="javascript:;">
                <div class="tk_MCConItTop clear">
                    <div class="tk_MCConItTitle">上传故障图片</div>
                </div>
                <ul class="tk_RTopPicMenu clear" style="padding-top: 0.25rem">
                    <li class="tk_RTopPicItem tk_RTopPicItIpt">
                        <div class="tk_RTopPicItIptIcon"></div>
                        <div class="tk_RTopPicItIptTxt">上传照片</div>
                        <input type="file" class="tk_RTopPicItIptInput" accept="image/*" multiple name="imageAttach">
                    </li>
                </ul>
            </a>
        </li>
        <li class="tk_MCConItem2">
            <a class="tk_MCConItHref2" href="javascript:;">
                <div class="tk_MCConItTop clear">
                    <div class="tk_MCConItTitle">上传故障图片</div>
                </div>
                <ul class="tk_MCConItMenu">
                    <li class="tk_MCConItItem">
                        <p class="tk_MCConItPara">主机风扇照常转，键盘灯一起亮了一下然后再也没反 应，显示屏显没信号后、下面的灯变成红的，也没有 反应了，怎么办</p>
                    </li>
                </ul>
            </a>
        </li>
    </ul>
    <section class="tk_apIBtnWrapper clear">
        <div class="tk_apIBtnL">
            <div class="tk_apIBtnLWrap">
                <i class="tk_apIBtnLIcon"></i>
                <span class="tk_apIBtnLTxt">资产二维码扫描</span>
            </div>
        </div>
        <button class="tk_apIBtnR">提交</button>
    </section>
</div>
<div class="tk_compPopUpWrapper none">
    <div class="tk_compPopUp">
        <div class="tk_compPopUpMsg">照片数量不能超过3张！</div>
        <div class="tk_compPopUpBtnWrapper">
            <div class="tk_compPopUpBtn">确定</div>
        </div>
    </div>
</div>

<script type="text/javascript" src="js/jquery-3.2.1.js"></script>

<script>
    $(".tk_compItemC").click(function () {
        $(this).siblings(".tk_compPopUp2Wrapper").removeClass("none")
    });
    $(".tk_compPopUp2Btn:nth-child(1)").click(function () {
        var iptValue=$(this).parents(".tk_compPopUp2").find(".tk_compPopUp2ItIpt:checked").val();
        $(this).parents(".tk_pMLItem").find(".tk_compItemCTxt").text(iptValue).addClass("on");
        $(this).parents(".tk_compPopUp2Wrapper").addClass("none")
    });
    $(".tk_compPopUp2Btn:nth-child(2)").click(function () {
        $(this).parents(".tk_compPopUp2Wrapper").addClass("none")
    });
    $(".tk_compItCItem").click(function () {
        $(this).parents(".tk_compItCMenu").slideUp();
        $(this).parents(".tk_compItCMenu").siblings(".tk_compItemC").children(".tk_compItemCTxt").text($(this).text()).addClass("on");
    });
    $(".tk_pMLPUpTitIcon").click(function () {
        $(this).parents(".tk_pMLPopUpWrapper").addClass("none")
    });




    /*点击camera按钮*/
    var input = document.querySelector('.tk_RTopPicItIptInput');
    var preview = document.querySelector('.tk_RTopPicMenu');
    var tk_RTopPicItIpt = document.querySelector('.tk_RTopPicItIpt');

    input.addEventListener('change', updateImageDisplay);
    function updateImageDisplay() {
        var curFiles = input.files;
        if (curFiles.length === 0) {
            /*var para = document.createElement('li');
             para.classList.add("tk_compPicItMsg");
             para.textContent = 'No files currently selected for upload';
             preview.appendChild(para);*/

        } else if (curFiles.length > 3) {
            /*判断数量*/
            $(".tk_compPopUpWrapper").removeClass("none");
            $(".tk_compPicItMsg").removeClass("none");
        } else {
            /*判断数量*/
            console.log($(".tk_RTopPicItem").length);
            console.log(curFiles.length)
            if ($(".tk_RTopPicItem").length + curFiles.length > 4) {
                $(".tk_compPopUpWrapper").removeClass("none");
                return;
            } else {
                for (var i = 0; i < curFiles.length; i++) {
                    var listItemDelete = document.createElement('div');
                    listItemDelete.classList.add("tk_RTopPicItDelete");
                    var listItem = document.createElement('li');
                    listItem.classList.add("tk_RTopPicItem");
                    var para = document.createElement('p');
                    if (validFileType(curFiles[i])) {
                        /*para.textContent = 'File name ' + curFiles[i].name + ', file size ' + returnFileSize(curFiles[i].size) + '.';*/
                        /*var image = document.createElement('img');*/
                        listItem.style.backgroundImage = "url(" + window.URL.createObjectURL(curFiles[i]) + ")";

                    } /*else {
                     para.textContent = 'File name ' + curFiles[i].name + ': Not a valid file type. Update your selection.';
                     listItem.appendChild(para);
                     }*/;

                    listItem.appendChild(listItemDelete);
                    preview.insertBefore(listItem,tk_RTopPicItIpt);

                }
            };

        }
    };
    var fileTypes = [
        'image/jpeg',
        'image/pjpeg',
        'image/png'
    ];

    function validFileType(file) {
        for (var i = 0; i < fileTypes.length; i++) {
            if (file.type === fileTypes[i]) {
                return true;
            }
        }
        return false;
    };
    //判断设备类型，动态添加capture属性：
    function getMobileOperatingSystem() {
        var userAgent = navigator.userAgent || navigator.vendor || window.opera;

        if (/android/i.test(userAgent)) {
            console.log("android");
            $(".tk_RTopPicItIptInput").attr("capture","camera");
        };

        if ((/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream)||/android 7.0/i.test(userAgent)) {
            console.log("iOS");
            $(".tk_RTopPicItIptInput").removeAttr("capture");
        };

        return "unknown";
    };
    getMobileOperatingSystem();
    /*删除图片*/
    $(".tk_RTopPicMenu").on("click",".tk_RTopPicItDelete",function () {
        $(this).parents(".tk_RTopPicItem").remove()
    });
    /*关闭弹窗*/
    $(".tk_compPopUpBtn").click(function () {
        $(this).parents(".tk_compPopUpWrapper").addClass("none")
    })
</script>
</body>
</html>